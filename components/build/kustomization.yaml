resources:
- openshift-pipelines/
- tekton-results/
- build-templates/
- pipelines-as-code/
- tekton-chains/
- .tekton/
- pvc-cleaner
- build-service/
- infra-deployments-ci/
- shared-resources

generatorOptions:
  disableNameSuffixHash: true

configMapGenerator:
- name: build-pipelines-defaults
  namespace: build-templates
  literals:
  - default_build_bundle=quay.io/redhat-appstudio/build-templates-bundle:19cf17aa63a1c65eee897af8430dbb9c1682d77a

# Skip applying the Tekton operands while the Tekton operator is being installed.
# See more information about this option, here:
# https://argo-cd.readthedocs.io/en/stable/user-guide/sync-options/#skip-dry-run-for-new-custom-resources-types
commonAnnotations:
  argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true

# This is done in this file so it can override the commonAnnotations above. Otherwise,
# it gets overwritten by kustomize. It also has to be done as patchesJSON6902 because
# this transformer runs after annotations transformer:
# https://github.com/kubernetes-sigs/kustomize/issues/3046
patchesJSON6902:
- target:
    kind: Deployment
    name: tekton-chains-controller
    namespace: tekton-chains
  # Note that ~1 below is how to represent an escaped /
  # See: http://jsonpatch.com/#json-pointer
  patch: |-
    - op: replace
      path: /metadata/annotations/argocd.argoproj.io~1sync-options
      # This is needed to ensure updates to immutable fields are properly applied.
      value: Replace=true

# value: SkipDryRunOnMissingResource=true,Replace=true
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
